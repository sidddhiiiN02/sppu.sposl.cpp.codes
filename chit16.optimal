//wirte a program to simulate page replacement algorithm.optimal sample input 
2, 3, 2, 1, 5, 2, 4, 5, 3, 2, 5, 2 and no. of frames is 3

#include <iostream>
#include <vector>
#include <unordered_set>
#include <climits>

using namespace std;

int main() {
    vector<int> page_string = {2, 3, 2, 1, 5, 2, 4, 5, 3, 2, 5, 2};
    int num_frames = 3;

    unordered_set<int> frames;
    vector<int> frame_vector;
    int page_faults = 0;

    cout << "--- Optimal Page Replacement ---" << endl;
    cout << "Frames: " << num_frames << endl << endl;

    for (int i = 0; i < page_string.size(); i++) {
        int page = page_string[i];
        cout << "Page " << page << ": ";

        if (frames.find(page) != frames.end()) {
            cout << "HIT." << endl;
            continue;
        }

        page_faults++;
        cout << "FAULT. ";

        if (frames.size() < num_frames) {
            frames.insert(page);
            frame_vector.push_back(page);
            cout << "Loaded " << page << "." << endl;
        } else {
            int victim = -1;
            int farthest_use = -1;

            for (int frame_page : frame_vector) {
                int next_use = INT_MAX;
                for (int j = i + 1; j < page_string.size(); j++) {
                    if (page_string[j] == frame_page) {
                        next_use = j;
                        break;
                    }
                }

                if (next_use > farthest_use) {
                    farthest_use = next_use;
                    victim = frame_page;
                }
            }

            frames.erase(victim);
            for(int k=0; k < frame_vector.size(); k++) {
                if (frame_vector[k] == victim) {
                    frame_vector[k] = page;
                    break;
                }
            }
            frames.insert(page);
            cout << "Evicted " << victim << ". Loaded " << page << "." << endl;
        }
    }

    cout << "\nTotal Page Faults: " << page_faults << endl;

    return 0;
}
